{% comment %}
  KUMO Hero Section
  Full-screen hero with customizable fade overlay
  Optional intro animation: image → fade to white → text slides in
{% endcomment %}

{%- liquid
  assign fade_opacity = section.settings.fade_opacity | default: 75
  assign fade_start = fade_opacity | times: 0.01
  assign fade_mid = fade_opacity | times: 0.008

  assign enable_animation = section.settings.enable_intro_animation
  assign image_duration = section.settings.image_display_duration | default: 1.5
  assign fade_duration = section.settings.fade_duration | default: 0.8
  assign text_delay = image_duration | plus: fade_duration
  assign text_stagger = 0.15
-%}

<section
  class="kumo-hero kumo-hero--align-{{ section.settings.content_alignment }}{% if enable_animation %} kumo-hero--animated{% endif %}"
  {% if enable_animation %}
    style="--anim-image-duration: {{ image_duration }}s; --anim-fade-duration: {{ fade_duration }}s; --anim-text-delay: {{ text_delay }}s; --anim-text-stagger: {{ text_stagger }}s;"
  {% endif %}
>
  {%- comment -%} Background Image {%- endcomment -%}
  <div class="kumo-hero__background">
    {%- if section.settings.image != blank -%}
      <img
        src="{{ section.settings.image | image_url: width: 1920 }}"
        alt="{{ section.settings.image.alt | default: section.settings.title_line1 | escape }}"
        class="kumo-hero__image"
        loading="eager"
        fetchpriority="high"
      >
    {%- else -%}
      <div class="kumo-hero__placeholder"></div>
    {%- endif -%}

    {%- comment -%} Gradient fade overlay - fades from left (text side) to right (image visible) {%- endcomment -%}
    <div class="kumo-hero__fade" style="background: linear-gradient(to right, hsla(35, 45%, 97%, {{ fade_start }}) 0%, hsla(35, 45%, 97%, {{ fade_start }}) 25%, hsla(35, 45%, 97%, {{ fade_mid }}) 50%, hsla(35, 45%, 97%, 0) 75%);"></div>

    {%- comment -%} Animated white overlay (only when animation enabled) {%- endcomment -%}
    {%- if enable_animation -%}
      <div class="kumo-hero__white-overlay"></div>
    {%- endif -%}
  </div>

  {%- comment -%} Content {%- endcomment -%}
  <div class="kumo-hero__content">
    <div class="kumo-container">
      <div class="kumo-hero__inner">
        <h1 class="kumo-hero__title{% if enable_animation %} kumo-hero__anim-slide{% else %} kumo-animate-fade-up{% endif %}">
          <span class="kumo-hero__title-line1">{{ section.settings.title_line1 }}</span>
          <span class="kumo-hero__title-line2">{{ section.settings.title_line2 }}</span>
        </h1>

        <p class="kumo-hero__description{% if enable_animation %} kumo-hero__anim-slide{% else %} kumo-animate-fade-up{% endif %}" style="{% if enable_animation %}--anim-index: 1;{% else %}animation-delay: 0.15s;{% endif %}">
          {{ section.settings.description }}
        </p>

        {%- if section.settings.button_text != blank -%}
          <div class="kumo-hero__cta{% if enable_animation %} kumo-hero__anim-slide{% else %} kumo-animate-fade-up{% endif %}" style="{% if enable_animation %}--anim-index: 2;{% else %}animation-delay: 0.3s;{% endif %}">
            <a href="{{ section.settings.button_link }}" class="kumo-btn-cozy">
              <span>{{ section.settings.button_text }}</span>
              {% render 'kumo-icon', icon: 'arrow-right' %}
            </a>
          </div>
        {%- endif -%}
      </div>
    </div>
  </div>
</section>

<style>
  .kumo-hero {
    position: relative;
    min-height: 100vh;
    display: flex;
    align-items: center;
    overflow: hidden;
  }

  .kumo-hero__background {
    position: absolute;
    inset: 0;
  }

  .kumo-hero__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center right;
  }

  .kumo-hero__placeholder {
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, hsl(35, 45%, 96%) 0%, hsl(30, 40%, 93%) 100%);
  }

  /* Fade overlay - gradient controlled via inline style */
  .kumo-hero__fade {
    position: absolute;
    inset: 0;
    pointer-events: none;
  }

  .kumo-hero__content {
    position: relative;
    z-index: 1;
    padding: 7rem 0 4rem;
    width: 100%;
  }

  .kumo-hero__inner {
    max-width: 32rem;
  }

  /* Title - tight spacing */
  .kumo-hero__title {
    font-family: var(--kumo-font-family);
    font-size: clamp(2.75rem, 7vw, 4.5rem);
    font-weight: 700;
    line-height: 1;
    margin-bottom: 1.25rem;
    letter-spacing: -0.03em;
  }

  .kumo-hero__title-line1 {
    display: block;
    color: var(--kumo-foreground);
  }

  .kumo-hero__title-line2 {
    display: block;
    color: var(--kumo-primary);
  }

  .kumo-hero__description {
    font-family: var(--kumo-font-family);
    font-size: 0.9375rem;
    line-height: 1.6;
    color: var(--kumo-muted-foreground);
    max-width: 24rem;
    margin-bottom: 1.75rem;
  }

  .kumo-hero__cta {
    display: inline-block;
  }

  /* Alignment: Left */
  .kumo-hero--align-left .kumo-hero__inner {
    text-align: left;
  }

  /* Alignment: Center */
  .kumo-hero--align-center {
    justify-content: center;
  }
  .kumo-hero--align-center .kumo-hero__inner {
    text-align: center;
    margin-left: auto;
    margin-right: auto;
  }
  .kumo-hero--align-center .kumo-hero__description {
    margin-left: auto;
    margin-right: auto;
  }
  .kumo-hero--align-center .kumo-hero__gradient {
    background: radial-gradient(
      ellipse at center,
      hsla(35, 45%, 97%, 0.85) 0%,
      hsla(35, 45%, 97%, 0.4) 50%,
      transparent 75%
    );
  }

  /* Alignment: Right */
  .kumo-hero--align-right {
    justify-content: flex-end;
  }
  .kumo-hero--align-right .kumo-hero__inner {
    text-align: right;
    margin-left: auto;
  }
  .kumo-hero--align-right .kumo-hero__description {
    margin-left: auto;
  }
  .kumo-hero--align-right .kumo-hero__gradient {
    background: linear-gradient(
      to left,
      hsla(35, 45%, 97%, 0.9) 0%,
      hsla(35, 45%, 97%, 0.5) 35%,
      transparent 60%
    );
  }

  /* Mobile */
  @media (max-width: 767px) {
    .kumo-hero {
      min-height: 100svh;
    }
    .kumo-hero__content {
      padding: 6rem 0 3rem;
    }
    .kumo-hero__title {
      font-size: 2.5rem;
    }
    .kumo-hero__gradient {
      background: linear-gradient(
        to bottom,
        hsla(35, 45%, 97%, 0.95) 0%,
        hsla(35, 45%, 97%, 0.6) 50%,
        transparent 100%
      );
    }
  }

  /* ═══════════════════════════════════════════════════════════════
     INTRO ANIMATION
     Sequence: Image visible → White fade in → Text slides from left
     ═══════════════════════════════════════════════════════════════ */

  /* White overlay - initially transparent, fades to semi-opaque */
  .kumo-hero__white-overlay {
    position: absolute;
    inset: 0;
    background: hsla(35, 45%, 97%, 0.65);
    opacity: 0;
    pointer-events: none;
    z-index: 1;
  }

  /* Animated state */
  .kumo-hero--animated .kumo-hero__white-overlay {
    animation: heroFadeToWhite var(--anim-fade-duration, 0.8s) ease-out forwards;
    animation-delay: var(--anim-image-duration, 1.5s);
  }

  @keyframes heroFadeToWhite {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  /* Text slide-in animation */
  .kumo-hero__anim-slide {
    opacity: 0;
    transform: translateX(-40px);
    animation: heroSlideIn 0.7s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    animation-delay: calc(var(--anim-text-delay, 2.3s) + (var(--anim-index, 0) * var(--anim-text-stagger, 0.15s)));
  }

  @keyframes heroSlideIn {
    from {
      opacity: 0;
      transform: translateX(-40px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  /* Respect reduced motion preference */
  @media (prefers-reduced-motion: reduce) {
    .kumo-hero--animated .kumo-hero__white-overlay,
    .kumo-hero__anim-slide {
      animation: none;
      opacity: 1;
      transform: none;
    }
  }

  /* Mobile animation adjustments */
  @media (max-width: 767px) {
    .kumo-hero__anim-slide {
      transform: translateX(-20px);
    }
    @keyframes heroSlideIn {
      from {
        opacity: 0;
        transform: translateX(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
  }
</style>

{% schema %}
{
  "name": "KUMO - Hero",
  "class": "kumo-hero-section",
  "settings": [
    {
      "type": "image_picker",
      "id": "image",
      "label": "Image de fond"
    },
    {
      "type": "range",
      "id": "fade_opacity",
      "min": 0,
      "max": 95,
      "step": 5,
      "unit": "%",
      "label": "Opacité du fondu (fade)",
      "default": 75,
      "info": "0% = image nette, 95% = image très fade"
    },
    {
      "type": "select",
      "id": "content_alignment",
      "label": "Alignement du contenu",
      "options": [
        { "value": "left", "label": "Gauche" },
        { "value": "center", "label": "Centre" },
        { "value": "right", "label": "Droite" }
      ],
      "default": "left"
    },
    {
      "type": "header",
      "content": "Animation d'intro"
    },
    {
      "type": "checkbox",
      "id": "enable_intro_animation",
      "label": "Activer l'animation d'intro",
      "default": false,
      "info": "Séquence: Image visible → Fondu blanc → Texte glisse depuis la gauche"
    },
    {
      "type": "range",
      "id": "image_display_duration",
      "min": 0.5,
      "max": 3,
      "step": 0.1,
      "unit": "s",
      "label": "Durée d'affichage de l'image",
      "default": 1.5,
      "info": "Temps avant le début du fondu blanc"
    },
    {
      "type": "range",
      "id": "fade_duration",
      "min": 0.3,
      "max": 1.5,
      "step": 0.1,
      "unit": "s",
      "label": "Durée du fondu blanc",
      "default": 0.8,
      "info": "Durée de la transition vers le blanc"
    },
    {
      "type": "header",
      "content": "Contenu"
    },
    {
      "type": "text",
      "id": "title_line1",
      "label": "Titre - Ligne 1",
      "default": "Cocooning"
    },
    {
      "type": "text",
      "id": "title_line2",
      "label": "Titre - Ligne 2 (colorée)",
      "default": "à chaque pas."
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "Transformez votre intérieur en un refuge. Découvrez le confort ultime de la collection KUMO."
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Texte du bouton",
      "default": "Explorer le Nuage"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Lien du bouton"
    }
  ],
  "presets": [
    {
      "name": "KUMO - Hero",
      "settings": {
        "title_line1": "Cocooning",
        "title_line2": "à chaque pas.",
        "description": "Transformez votre intérieur en un refuge. Découvrez le confort ultime de la collection KUMO.",
        "button_text": "Explorer le Nuage",
        "content_alignment": "left",
        "fade_opacity": 75,
        "enable_intro_animation": false,
        "image_display_duration": 1.5,
        "fade_duration": 0.8
      }
    }
  ]
}
{% endschema %}
