{% comment %}
  KUMO Instagram Section
  UGC / Instagram feed display
{% endcomment %}

<section class="kumo-instagram kumo-section">
  <div class="kumo-container">
    {%- comment -%} Section Header {%- endcomment -%}
    <div class="kumo-text-center kumo-reveal" style="margin-bottom: 2rem;">
      <h2 class="kumo-section-title kumo-text-fluffy">{{ section.settings.title }}</h2>
      {%- if section.settings.handle != blank -%}
        <a href="https://instagram.com/{{ section.settings.handle }}" target="_blank" rel="noopener" class="kumo-instagram__handle">
          {% render 'kumo-icon', icon: 'instagram' %}
          @{{ section.settings.handle }}
        </a>
      {%- endif -%}
    </div>

    {%- comment -%} Instagram Grid {%- endcomment -%}
    <div class="kumo-instagram__grid">
      {%- for block in section.blocks -%}
        <a
          href="{{ block.settings.link | default: '#' }}"
          class="kumo-instagram__item kumo-reveal"
          style="animation-delay: {{ forloop.index0 | times: 0.05 }}s;"
          target="_blank"
          rel="noopener"
          {{ block.shopify_attributes }}
        >
          {%- if block.settings.image != blank -%}
            <img
              src="{{ block.settings.image | image_url: width: 400 }}"
              alt="{{ block.settings.alt | default: 'Instagram post' }}"
              class="kumo-instagram__image"
              loading="lazy"
            >
          {%- else -%}
            <div class="kumo-instagram__placeholder">
              {% render 'kumo-icon', icon: 'instagram' %}
            </div>
          {%- endif -%}
          <div class="kumo-instagram__overlay">
            {% render 'kumo-icon', icon: 'instagram' %}
          </div>
        </a>
      {%- endfor -%}
    </div>

    {%- comment -%} CTA {%- endcomment -%}
    {%- if section.settings.show_cta and section.settings.handle != blank -%}
      <div class="kumo-text-center kumo-reveal" style="margin-top: 2rem;">
        <a href="https://instagram.com/{{ section.settings.handle }}" target="_blank" rel="noopener" class="kumo-btn-secondary" style="display: inline-flex; width: auto;">
          Suivez-nous sur Instagram
          {% render 'kumo-icon', icon: 'arrow-right' %}
        </a>
      </div>
    {%- endif -%}
  </div>
</section>

<style>
  .kumo-instagram__handle {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    font-family: var(--kumo-font-family);
    font-weight: 500;
    font-size: 1rem;
    color: var(--kumo-primary);
    text-decoration: none;
    margin-top: 0.5rem;
    transition: gap 0.2s ease;
  }

  .kumo-instagram__handle:hover {
    gap: 0.75rem;
  }

  .kumo-instagram__handle svg {
    width: 1.25rem;
    height: 1.25rem;
  }

  .kumo-instagram__grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 0.5rem;
  }

  @media (min-width: 640px) {
    .kumo-instagram__grid {
      grid-template-columns: repeat(3, 1fr);
      gap: 0.75rem;
    }
  }

  @media (min-width: 1024px) {
    .kumo-instagram__grid {
      grid-template-columns: repeat(6, 1fr);
      gap: 1rem;
    }
  }

  .kumo-instagram__item {
    position: relative;
    aspect-ratio: 1 / 1;
    border-radius: var(--kumo-radius);
    overflow: hidden;
    display: block;
  }

  .kumo-instagram__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s ease;
  }

  .kumo-instagram__placeholder {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, var(--kumo-cream-200), var(--kumo-cream-300));
  }

  .kumo-instagram__placeholder svg {
    width: 2rem;
    height: 2rem;
    color: var(--kumo-muted-foreground);
    opacity: 0.5;
  }

  .kumo-instagram__overlay {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: rgba(0, 0, 0, 0.4);
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .kumo-instagram__overlay svg {
    width: 2rem;
    height: 2rem;
    color: white;
  }

  .kumo-instagram__item:hover .kumo-instagram__overlay {
    opacity: 1;
  }

  .kumo-instagram__item:hover .kumo-instagram__image {
    transform: scale(1.1);
  }
</style>

{% schema %}
{
  "name": "KUMO - Instagram",
  "class": "kumo-instagram-section",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Titre",
      "default": "#KUMOFamily"
    },
    {
      "type": "text",
      "id": "handle",
      "label": "Nom Instagram (sans @)",
      "default": "kumo.official"
    },
    {
      "type": "checkbox",
      "id": "show_cta",
      "label": "Afficher le bouton",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "image",
      "name": "Image",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Lien vers le post"
        },
        {
          "type": "text",
          "id": "alt",
          "label": "Texte alternatif"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "KUMO - Instagram",
      "settings": {
        "title": "#KUMOFamily",
        "handle": "kumo.official",
        "show_cta": true
      },
      "blocks": [
        { "type": "image" },
        { "type": "image" },
        { "type": "image" },
        { "type": "image" },
        { "type": "image" },
        { "type": "image" }
      ]
    }
  ]
}
{% endschema %}
